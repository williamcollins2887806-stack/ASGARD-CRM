<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>АСГАРД CRM</title>

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico"/>
  <link rel="icon" type="image/png" sizes="32x32" href="assets/img/icon-32.png"/>
  <link rel="icon" type="image/png" sizes="16x16" href="assets/img/icon-16.png"/>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json"/>
  <meta name="theme-color" content="#C62828"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="apple-mobile-web-app-title" content="АСГАРД CRM"/>
  <link rel="apple-touch-icon" href="assets/img/apple-touch-icon.png"/>
  <link rel="apple-touch-icon" sizes="180x180" href="assets/img/apple-touch-icon.png"/>
  <link rel="apple-touch-icon" sizes="192x192" href="assets/img/icon-192.png"/>

  <!-- Описание -->
  <meta name="description" content="CRM система АСГАРД-СЕРВИС для управления тендерами, работами и персоналом"/>

  <!-- Google Fonts: Inter + JetBrains Mono -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet"/>

  <!-- Design System CSS -->
  <link rel="stylesheet" href="assets/css/design-tokens.css"/>
  <link rel="stylesheet" href="assets/css/components.css"/>
  <link rel="stylesheet" href="assets/css/layout.css"/>
  <link rel="stylesheet" href="assets/css/app.css"/>

  <!-- Theme initialization (before render) -->
  <script>(function(){try{var t=localStorage.getItem("asgard_theme")||"dark";document.documentElement.dataset.theme=t==="light"?"light":"dark";}catch(e){}})();</script>
</head>
<body>
  <div id="app"><noscript>Для работы требуется JavaScript.</noscript></div>
  <script src="assets/js/db.js"></script>
  <script src="assets/js/ui.js"></script>
  <script src="assets/js/validate.js"></script>
  <script src="assets/js/confirm.js"></script>
  <script src="assets/js/safe_mode.js"></script>
  <script src="assets/js/build_info.js"></script>
  <script src="assets/js/auth.js"></script>
  <script src="assets/js/router.js"></script>
  <script src="assets/js/sla.js"></script>
  <script src="assets/js/booking.js"></script>
  <script src="assets/js/seed.js"></script>
  <script src="assets/js/templates.js"></script>
  <script src="assets/js/docs_pack.js"></script>
  <script src="assets/js/backup.js"></script>
  <script src="assets/js/alerts.js"></script>
  <script src="assets/js/gantt.js"></script>
  <script src="assets/js/gantt_full.js"></script>
  <script src="assets/js/charts.js"></script>
  <script src="assets/js/calc_cities.js"></script>
    <script src="assets/js/calc_norms.js"></script>
    <script src="assets/js/calc_equipment.js"></script>
    <script src="assets/js/calculator_v2.js"></script>
    <script src="assets/js/calculator.js"></script>
  <script src="assets/js/tenders.js"></script>
  <script src="assets/js/customers.js"></script>
  <script src="assets/js/pm_calcs.js"></script>
  <script src="assets/js/approvals.js"></script>
  <script src="assets/js/pm_works.js"></script>
  <script src="assets/js/work_expenses.js"></script>
  <script src="assets/js/buh_registry.js"></script>
  <script src="assets/js/office_expenses.js"></script>
  <script src="assets/js/correspondence.js"></script>
  <script src="assets/js/proxies.js"></script>
  <script src="assets/js/user_requests.js"></script>
  <script src="assets/js/travel.js"></script>
  <script src="assets/js/dashboard.js"></script>
  <script src="assets/js/export.js"></script>
  <script src="assets/js/all_works.js"></script>
  <script src="assets/js/all_estimates.js"></script>
  <script src="assets/js/kpi_works.js"></script>
  <script src="assets/js/kpi_money.js"></script>
  <script src="assets/js/tkp_followup.js"></script>
  <script src="assets/js/finances.js"></script>
  <script src="assets/js/bank_import.js"></script>
  <script src="assets/js/auto_reports.js"></script>
  <script src="assets/js/notifications_helper.js"></script>
  <script src="assets/js/geo_score.js"></script>
  <script src="assets/js/acts.js"></script>
  <script src="assets/js/invoices.js"></script>
  <script src="assets/js/warehouse.js"></script>
  <script src="assets/js/my_equipment.js"></script>
  <script src="assets/js/equipment.js"></script>
  <script src="assets/js/email.js"></script>
  <script src="assets/js/reminders.js"></script>
  <script src="assets/js/global_search.js"></script>
  <script src="assets/js/mobile.js"></script>
  <script src="assets/js/mimir_ai.js"></script>
  <script src="assets/js/settings.js"></script>
  <script src="assets/js/hr_requests.js"></script>
  <script src="assets/js/proc_requests.js"></script>
  <script src="assets/js/personnel.js"></script>
  <script src="assets/js/hr_rating.js"></script>
  <script src="assets/js/employee.js"></script>
  <script src="assets/js/staff_schedule.js"></script>
  <script src="assets/js/office_schedule.js"></script>
  <script src="assets/js/birthdays.js"></script>
  <script src="assets/js/calendar.js"></script>
  <script src="assets/js/funnel.js"></script>
  <script src="assets/js/contracts.js"></script>
  <script src="assets/js/seals.js"></script>
  <script src="assets/js/permits.js"></script>
  <script src="assets/js/bonus_approval.js"></script>
  <script src="assets/js/telegram.js"></script>
  <script src="assets/js/sync.js"></script>
  <script src="assets/js/chat.js"></script>
  <script src="assets/js/mimir.js"></script>
  <script src="assets/js/receipt_scanner.js"></script>
  <script src="assets/js/custom_dashboard.js"></script>
  <script src="assets/js/qr_codes.js"></script>
  <script src="assets/js/fx.js"></script>
  <script src="assets/js/mango.js"></script>
  <script src="assets/js/pm_consents.js"></script>
  <script src="assets/js/cash.js"></script>
  <script src="assets/js/cash_admin.js"></script>
  <script src="assets/js/tasks.js"></script>
  <script src="assets/js/tasks_admin.js"></script>
  <script src="assets/js/diag.js"></script>
  <script src="assets/js/theme.js"></script>
  <script src="assets/js/app.js"></script>
  
  <!-- PWA Service Worker Registration -->
  <script>
    // Service Worker только
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => {
            console.log('[PWA] Service Worker registered:', reg.scope);
            reg.addEventListener('updatefound', () => {
              const newWorker = reg.installing;
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  if (window.AsgardUI && window.AsgardUI.toast) {
                    window.AsgardUI.toast('Обновление', 'Доступна новая версия. Обновите страницу.', 'info', 10000);
                  }
                }
              });
            });
          })
          .catch(err => console.log('[PWA] SW registration failed:', err));
      });
    }
  </script>
</body>
</html>
